Окей, идём по-взрослому: один модуль — один мозг. Начинаем с `areas`.

Ниже — **полная спека модуля `areas`** в духе того, как клиент описывал ТЗ, только нормально структурировано. Можешь сохранить как `AREAS_SPEC.md` и по нему реализовывать.

---

````md
# Модуль: Areas (Сферы жизни)

Модуль `areas` отвечает за **сферы колеса жизни**, которые везде используются в продукте.

Цитата из ТЗ (смысл, не дословно):

> Сферы колеса жизни, которые везде используются:
> 1. Деньги и бизнес  
> 2. Здоровье и тело  
> 3. Психика и энергия  
> 4. Отношения и близкие / окружение  
> 5. Дом и быт  
> 6. Развитие и знания  
> 7. Свобода и впечатления  
> 8. Вклад и смысл.  
>
> Важное требование к продукту: все сущности так или иначе привязаны и к сферам, и к временным горизонтам (1/3/5, 35–36, 2026).

То есть `areas` — это **базовый справочник**, к которому привязаны:

- колесо жизни (`LifeWheel`),
- цели (`Goals`),
- шаги/лестница (`Steps`),
- диагностика желаний (`WantsAnalysis`),
- годовой план, стандарты 35–36 и т.д.

Поэтому модуль должен быть:

- стабильным (коды не меняются),
- простым для чтения,
- минимально изменяемым снаружи.

---

## 1. Модель данных

### 1.1. Таблица `areas`

**Назначение:** хранит список сфер жизни, используемых во всём продукте.

**Имя таблицы:** `areas`

**Поля:**

- `id: string` — **PK, код сферы**, стабильный, используется во всех внешних связях  
  Примеры кодов:
  - `money_business`
  - `health_body`
  - `mind_energy`
  - `relationships`
  - `home_life`
  - `growth_knowledge`
  - `freedom_experience`
  - `contribution_meaning`

- `title: string` — человекочитаемое название (на текущем языке продукта, сейчас RU)  
  Примеры:
  - `Деньги и бизнес`
  - `Здоровье и тело`
  - `Психика и энергия`
  - `Отношения и близкие / окружение`
  - `Дом и быт`
  - `Развитие и знания`
  - `Свобода и впечатления`
  - `Вклад и смысл`

- `description: text | null` — расширенное описание сферы (для подсказок в UI и текстов AI).  
  Например:
  - для `money_business`: «Доход, финподушка, бизнес, работа, инвестиции»
  - для `health_body`: «Физическое здоровье, сон, питание, тело»

- `order_index: int` — порядок отображения (1–8 по списку из ТЗ).

- `is_active: bool` — использовать ли эту сферу в продукте (по умолчанию `true`).

- `created_at: timestamptz` — дата создания записи.

- `updated_at: timestamptz` — дата последнего изменения.

> Важно: **клиент явно зафиксировал 8 сфер**.  
> Они сидятся один раз и далее используются везде.  
> Для обычного пользователя это read-only справочник.

---

## 2. Pydantic-схемы (API-слой)

Схемы для endpoint’ов модуля `areas`:

### 2.1. `AreaPublic`

То, что отдаём наружу.

```python
class AreaPublic(BaseModel):
    id: str                 # "money_business"
    title: str              # "Деньги и бизнес"
    description: str | None
    order_index: int
    is_active: bool
````

### 2.2. (Опционально, для админки) `AreaCreate` и `AreaUpdate`

Если потом будет админ-панель.

```python
class AreaCreate(BaseModel):
    id: str                 # код, задаётся один раз
    title: str
    description: str | None = None
    order_index: int = 1
    is_active: bool = True


class AreaUpdate(BaseModel):
    title: str | None = None
    description: str | None = None
    order_index: int | None = None
    is_active: bool | None = None
```

Но на уровне обычного пользователя **никаких create/update/delete нет**, всё только на чтение.

---

## 3. API эндпоинты модуля `areas`

Все ответы — в формате твоего `StandardResponse`. Ниже описываю только структуру `result`.

### 3.1. `GET /api/v1/areas`

**Описание:**
Вернуть список всех активных сфер, отсортированных по `order_index`.

**Auth:**

* Можно сделать **Auth: required** (так как всё равно почти весь продукт приватный).
* Либо позже открыть публично, если решите.

**Query-параметры (опционально):**

* `include_inactive: bool = false` — если `true`, вернуть и деактивированные сферы (для админки).

**Ответ (успех):**

```json
{
  "ok": true,
  "result": [
    {
      "id": "money_business",
      "title": "Деньги и бизнес",
      "description": "Доход, бизнес, финподушка, работа...",
      "order_index": 1,
      "is_active": true
    },
    {
      "id": "health_body",
      "title": "Здоровье и тело",
      "description": "Сон, питание, спорт, самочувствие...",
      "order_index": 2,
      "is_active": true
    }
    // ... остальные
  ],
  "error": null,
  "meta": {
    "request_id": "...",
    "timestamp": "...",
    "pagination": null
  }
}
```

**Поведение:**

* По умолчанию:

  * `WHERE is_active = true`
  * `ORDER BY order_index ASC, id ASC`
* Для внутренней логики (LifeWheel, Goals, AI) фронт всегда должен использовать именно `id`.

---

### 3.2. `GET /api/v1/areas/{area_id}`

**Описание:**
Получить детальную информацию по одной сфере (по коду).

**Auth:** да.

**Параметры пути:**

* `area_id: string` — код сферы, например: `money_business`.

**Ответ (успех):**

```json
{
  "ok": true,
  "result": {
    "id": "money_business",
    "title": "Деньги и бизнес",
    "description": "Доход, бизнес, финподушка, работа...",
    "order_index": 1,
    "is_active": true
  },
  "error": null,
  "meta": {
    "request_id": "...",
    "timestamp": "...",
    "pagination": null
  }
}
```

**Ответ (если не найдено):**

```json
{
  "ok": false,
  "result": null,
  "error": {
    "code": "AREA_NOT_FOUND",
    "http_code": 404,
    "message": "Сфера с таким id не найдена",
    "details": null,
    "fields": {
      "area_id": ["Неизвестный код сферы"]
    }
  },
  "meta": {
    "request_id": "...",
    "timestamp": "...",
    "pagination": null
  }
}
```

---

### 3.3. (Опционально, чисто для админки) `POST /api/v1/areas`

**Описание:**
Создать новую сферу жизни.
**В реальном продукте пока НЕ НУЖНО для юзеров**, но на будущее — админ API.

**Auth:** только админ (`is_superuser = true`).

**Body:** `AreaCreate`

**Ответ:**

`result` = созданный `AreaPublic`.

---

### 3.4. (Опционально, админка) `PUT /api/v1/areas/{area_id}`

**Описание:**
Обновить поля сферы (название, описание, порядок, is_active).

**Auth:** только админ.

**Body:** `AreaUpdate`

**Ответ:**

`result` = обновлённый `AreaPublic`.

---

### 3.5. (Опционально, админка) `DELETE /api/v1/areas/{area_id}`

Лучше **не удалять физически** (из-за связей с `LifeWheel`, `Goals` и т.д.), а:

* либо запрещать удаление вообще,
* либо заменять на `is_active = false`.

Если всё-таки делать:

* `DELETE` переводит `is_active = false` и НЕ трогает записи в других таблицах.
* В обычных эндпоинтах всё ещё можно не показывать неактивные сферы.

---

## 4. Как модуль `areas` используется дальше (важно для архитектуры)

Из ТЗ:

> Важное требование: всё так или иначе привязано к сферам и временным горизонтам.

То есть:

* `LifeWheel` хранит оценки по сферам:

  * `scores: { "money_business": 3, "health_body": 7, ... }`
* `Goals` имеет поле `area_id: string` (`FK → areas.id`)
* `Steps`, `WantsAnalysis`, `FutureStory`, `YearPlan2026` и т.д. тоже должны ссылаться на `areas.id`.

**Критично:**

* Коды `id` из таблицы `areas` — это **единый источник правды** для всего проекта.
* Никаких “вольных” строк типа `"Деньги"` не должно летать по базе — только ссылки на `areas.id`.

---

## 5. Мини-роадмап по реализации модуля `areas`

1. **Сделать миграцию Alembic** для таблицы `areas`.

2. **Сделать сидинг** (команда или отдельный скрипт), который создаёт 8 сфер:

   | id                   | title                           | order_index |
   | -------------------- | ------------------------------- | ----------- |
   | money_business       | Деньги и бизнес                 | 1           |
   | health_body          | Здоровье и тело                 | 2           |
   | mind_energy          | Психика и энергия               | 3           |
   | relationships        | Отношения и близкие / окружение | 4           |
   | home_life            | Дом и быт                       | 5           |
   | growth_knowledge     | Развитие и знания               | 6           |
   | freedom_experience   | Свобода и впечатления           | 7           |
   | contribution_meaning | Вклад и смысл                   | 8           |

3. **Сделать Pydantic-схемы**: `AreaPublic` (+ при желании `AreaCreate`, `AreaUpdate`).

4. **Реализовать эндпоинты**:

   * `GET /api/v1/areas`
   * `GET /api/v1/areas/{area_id}`

5. **Обновить** все следующие модули (когда до них дойдём), чтобы они использовали только `areas.id`:

   * `LifeWheel`
   * `Goals`
   * `WantsAnalysis`, `FutureStory`, и т.д.

---

## 6. Резюме

Модуль `areas` по ТЗ — это:

* фиксированный справочник из 8 сфер,
* который:

  * читается фронтом,
  * используется AI,
  * выступает фундаментом для всех целей/колёс/планов.

На уровне API для пользователя:
**достаточно двух ручек** — `GET /areas` и `GET /areas/{id}`.
Всё остальное — для админки/будущего. ( пока что эндепоинты для админов не делать , только основные для юзеров )